(function(){var f=!1,e=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(g){function a(){!f&&this.init&&this.init.apply(this,arguments)}var c=this.prototype;f=!0;var b=new this;f=!1;for(var d in g)b[d]=typeof g[d]=="function"&&typeof c[d]=="function"&&e.test(g[d])?function(a,b){return function(){var d=this._super;this._super=c[a];var e=b.apply(this,arguments);this._super=d;return e}}(d,g[d]):g[d];a.prototype=b;a.constructor=a;a.extend=arguments.callee;return a}})();
(function(){if(!window.console){var f=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];window.console={};for(var e=function(){},g=0;g<f.length;++g)window.console[f[g]]=e}})();function isUndefined(f){return f===null||typeof f==="undefined"}function mergeObjects(f,e){var g={};for(attrname in f)g[attrname]=f[attrname];for(attrname in e)g[attrname]=e[attrname];return g}
function getEventTarget(f){f=f||window.event;return f.target||f.srcElement}
var Dizzy=function(f,e,g,a){return g.extend({init:function(c,b){if(this===f)return new Dizz(c,presentationOptions);this.container=$(c);this.canvas=this.svg=a;this.currentGroup=0;this.options=mergeObjects({transformDuration:1E3},b)},load:function(a,b){var d=this;this.container.empty().removeClass("hasSVG").svg({loadURL:a,onLoad:function(){d.svg=d.container.svg("get");d.canvas=$("g#canvas",d.svg.root());isUndefined(b)||b.call(d);d.container.trigger("ready.dizzy");d.updateDisplay()}})},next:function(){return this.show(this.currentGroup+
1)},previous:function(){return this.show(this.currentGroup-1)},show:function(a){if(a>=0&&(this.hasGroup(a)||a===0))this.currentGroup=a,this.updateDisplay();return a},hasGroup:function(a){return this.getGroup(a).size()>0},getGroup:function(a){return $("g.group_"+a,this.svg.root())},getTransformationMatrix:function(a){var b=this;if(!isUndefined(a)){isUndefined(a.selector)||(a=a[0]);var d=a.transform.baseVal;if(d.numberOfItems===0){var e=this.svg.root().createSVGTransform();d.appendItem(e)}var f=d.consolidate().matrix;
$(a).parentsUntil("g#canvas, svg").each(function(){var a=$(this)[0].transform;if(typeof a!=="undefined")a=a.baseVal;if(a.numberOfItems===0){var c=b.svg.root().createSVGTransform();a.appendItem(c)}f=a.consolidate().matrix.multiply(f)});return f}},transformationMatrixToString:function(a){return"matrix("+a.a+" "+a.b+" "+a.c+" "+a.d+" "+a.e+" "+a.f+")"},transform:function(a,b,d){isUndefined(a.selector)||(a=a[0]);if(isUndefined(d))d=this.options.transformDuration;d===0?$(a).attr("transform",this.transformationMatrixToString(b)):
$(a).animate({svgTransform:this.transformationMatrixToString(b)},d);this.canvas.trigger("transformed")},updateDisplay:function(){if(this.currentGroup>=0)if(this.currentGroup===0)this.canvas.animate({svgTransform:"matrix(1 0 0 1 0 0)"},this.options.transformDuration);else{var a=this.getGroup(this.currentGroup);a.length>0&&this.transform(this.canvas,this.getTransformationMatrix(a[0]).inverse())}},transformAbsoluteCoordinates:function(a,b,d,e){if(typeof d==="undefined")d=this.canvas;typeof e==="undefined"&&
(e=!1);var f=this.svg.root().createSVGPoint();f.x=a;f.y=b;if(!isUndefined(d[0])&&!isUndefined(d[0].transform)&&!isUndefined(d[0].transform.baseVal.consolidate()))a=d[0].transform.baseVal.consolidate().matrix,e===!0&&(a=this.canvas[0].transform.baseVal.consolidate().matrix.multiply(a)),f=f.matrixTransform(a.inverse());return f},serialize:function(){$(this.svg.root()).attr("xmlns","http://www.w3.org/2000/svg");$(".group:empty",this.svg.root()).remove();return this.svg.toSVG()}})}(window,document,Class),
Dizzy=function(f,e,g){return g.extend({init:function(){this._super.apply(this,arguments);var a=this;$(e).bind("dizzy.color.changed",function(c){a.color=c})},color:{stroke:"#FFFFFF",fill:"#000000"}})}(window,document,Dizzy),Dizzy=function(f,e,g){var a={},f=g.extend({init:function(){this._super.apply(this,arguments);for(p in a)p.state=!1},setPluginState:function(c,b,d){var e=a[c];if(isUndefined(e))console.warn("Requested plugin '"+c+"' not registered in dizzy!");else{c=e.depends;e.dependencies={};for(var f in c){var g=
this.setPluginState(c[f],b,e.options[c[f]]);isUndefined(g)||(e.dependencies[g.name]=g)}if(e.state!==b)b===!0?(e.optionsBackup=e.options,e.options=mergeObjects(e.options,d),e.initialize(this)):(e.options=e.optionsBackup||e.options,e.finalize(this)),e.state=b;return e}},switchPlugin:function(c){this.activePlugin=c;for(var b in a)this.setPluginState(b,!1);return this.setPluginState(c,!0)},savePluginState:function(){this.stateBackup=this.activePlugin},restorePluginState:function(){this.switchPlugin(this.stateBackup)}});
f.registerPlugin=function(c){if(isUndefined(a[c.name]))c.options=c.options||{},a[c.name]=c};return f}(window,document,Dizzy);
(function(f,e,g){g.registerPlugin({name:"zoom",depends:[],options:{duration:200,factor:2},initialize:function(a){var c=this;$(e).bind("mousewheel",function(b,d){c.zoom(a,d,b)})},zoom:function(a,c,b){var c=Math.pow(this.options.factor,c),d=a.getTransformationMatrix(a.canvas);isUndefined(b)||(b=a.transformAbsoluteCoordinates(b.pageX,b.pageY),d=d.translate(-b.x*(c-1),-b.y*(c-1)));d=d.scale(c);a.transform(a.canvas,d,this.options.duration);$(e).trigger("transformed")},finalize:function(){$(e).unbind("mousewheel")}})})(window,
document,Dizzy);
(function(f,e,g){g.registerPlugin({name:"pan",depends:[],initialize:function(a){var c=this;this.panningInfo={};$(a.svg.root()).bind("mousedown",function(b){return c.startPanning(a,b)})},startPanning:function(a,c){var b=this;c.preventDefault();var d=a.transformAbsoluteCoordinates(c.pageX,c.pageY);this.panningInfo.x=d.x;this.panningInfo.y=d.y;d=function(c){return b.endPanning(a,c)};$(e).bind("mousemove.dizzy.panning",function(c){return b.panning(a,c)}).bind("mouseup.dizzy.panning",d).bind("mouseleave.dizzy.panning",d);
$(e).trigger("transformed");return!1},panning:function(a,c){var b=a.getTransformationMatrix(a.canvas),b=a.transformAbsoluteCoordinates(c.pageX,c.pageY),d={x:b.x-this.panningInfo.x,y:b.y-this.panningInfo.y},b=a.getTransformationMatrix(a.canvas),b=b.translate(d.x,d.y);a.canvas.attr("transform",a.transformationMatrixToString(b));b=a.transformAbsoluteCoordinates(c.pageX,c.pageY);this.panningInfo.x=b.x;this.panningInfo.y=b.y;return!1},endPanning:function(a,c){c.stopPropagation();$(e).unbind("mousemove.dizzy.panning");
this.panningInfo={};return!1},finalize:function(a){$(a.svg.root()).unbind("mousedown")}})})(window,document,Dizzy);(function(f,e,g){g.registerPlugin({name:"presentation",depends:["zoom","pan","keyboardnavigation"],options:{zoom:{duration:200}},initialize:function(a){$(a.svg.root()).removeClass("editing")},finalize:function(a){$(a.svg.root()).addClass("editing")}})})(window,document,Dizzy);
(function(f,e,g){g.registerPlugin({name:"editor.text",depends:[],options:{},initialize:function(a){var c=this;c.dizzy=a;$(e).bind("keypress.dizzy.editor",function(a){return c.keyPressed(a)});$(e).bind("keydown.dizzy.editor",function(a){return c.keyDown(a)})},keyPressed:function(a){a.preventDefault();var c=$(".zebraSelected").first();if(c.size()===0){var b=$(this.dizzy.svg.other($("#canvas"),"g"));b.attr("class","group");var d=this.dizzy.getTransformationMatrix(this.dizzy.canvas).inverse();b.attr("transform",
this.dizzy.transformationMatrixToString(d));d=$(this.dizzy.svg.other(b,"text"));c=$(this.dizzy.svg.other(c,"tspan"));d.attr({y:"50%",stroke:this.dizzy.color.stroke,fill:this.dizzy.color.fill});c.attr("x","50%");d.append(c);b.append(d);d.addClass("zebraSelected");c=d}c=c.children().last();b=c.text();a.which!==0&&a.which!==8&&c.text(b+String.fromCharCode(a.which));return!0},keyDown:function(a){var c=$(".zebraSelected").first();if(c.size()!==0)if(a.which===13)return c=$(this.dizzy.svg.other(c[0],"tspan")),
c.attr("x","50%").attr("dy",f.getComputedStyle(c[0],null).getPropertyValue("font-size")),!1;else if(a.which===46||a.which===0&&a.keyCode===46)return this.removeNode(c.parents("g.group")),$(e).trigger("hideZebra"),!1;else if(a.which===8){var a=c.children("tspan").last(),b=a.text();b.length!==0&&a.text(b.substr(0,b.length-1));b.length===0&&a.remove();c.children().size()===0&&(c.remove(),$(e).trigger("hideZebra"));return!1}return!0},removeNode:function(a){$(a,this.dizzy.svg.root()).remove()},finalize:function(){$(e).unbind("keypress.dizzy.editor");
$(e).unbind("keydown.dizzy.editor")}})})(window,document,Dizzy);
(function(f,e,g){g.registerPlugin({name:"editor.images",depends:[],initialize:function(a){var c=this;this.dizzy=a;f.File&&f.FileReader&&f.FileList&&($(a.svg.root()).bind("dragover.dizzy.editor",function(a){a.stopPropagation();a.preventDefault()}),$(a.svg.root()).bind("drop.dizzy.editor",function(a){return c.fileDropped(a)}));$(e).bind("addImage",function(a,d){return c.addImage(d)})},fileDropped:function(a){a=a.originalEvent;a.stopPropagation();a.preventDefault();var a=a.dataTransfer.files,c=new FileReader;
c.onload=function(a){$(e).trigger("addImage",[a.target.result])};var b;for(b=0;b<a.length;++b)a[b].type.indexOf("image/")>=0&&c.readAsDataURL(a[b])},addImage:function(a){var c=this,b=$(".zebraSelected"),d=$(c.dizzy.svg.other($("#canvas"),"g"));d.attr("class","group");var f=c.dizzy.getTransformationMatrix(c.dizzy.canvas).inverse();d.attr("transform",c.dizzy.transformationMatrixToString(f));b=selectedGroup=d;b.addClass("zebraSelected");var g=new Image;g.onload=function(){var f=$(c.dizzy.svg.image(d,
($(e).width()-g.width)/2,($(e).height()-g.height)/2,g.width,g.height,a));b.append(f);g.src="";selectedTarget=f};g.src=a},finalize:function(a){f.File&&f.FileReader&&f.FileList&&($(a.svg.root()).unbind("dragover.dizzy.editor"),$(a.svg.root()).unbind("drop.dizzy.editor"));$(e).unbind("addImage")}})})(window,document,Dizzy);
(function(f,e,g){g.registerPlugin({name:"editor.tools",depends:[],initialize:function(a){var c=this;this.dizzy=a;$("#zebra-toolbar-up").bind("click",function(){c.raiseLayer()});$("#zebra-toolbar-down").bind("click",function(){c.lowerLayer()});$("#zebra-toolbar-group").bind("click",function(){c.group()});$("#zebra-toolbar-ungroup").bind("click",function(){c.ungroup()})},lowerLayer:function(){var a=$(".zebraSelected",this.dizzy.svg.root());a.hasClass("group")||(a=a.parents("g.group").first());a.insertBefore(a.prev("g.group"))},
raiseLayer:function(){var a=$(".zebraSelected",this.dizzy.svg.root());a.hasClass("group")||(a=a.parents("g.group").first());a.insertAfter(a.next("g.group"))},group:function(){for(var a=$(".zebraSelected",this.dizzy.svg.root()).parents("g.group"),c=a.first(),b=1;b<a.size();++b)c.append(a[b].children()),c.addClass(a[b].attr("class"))},ungroup:function(){var a=$(".zebraSelected",this.dizzy.svg.root());a.hasClass("group")||(a=a.parents("g.group").first());var c=a.children().not(":first");a.after(c.wrap('<g class="group" />'))},
finalize:function(){$("#zebra-toolbar-up").unbind("click");$("#zebra-toolbar-down").unbind("click");$("#zebra-toolbar-group").unbind("click");$("#zebra-toolbar-ungroup").unbind("click")}})})(window,document,Dizzy);
(function(f,e,g){g.registerPlugin({name:"editor.path",depends:["pan","zoom"],initialize:function(a){var c=this;this.dizzy=a;this.maxPathNumber=0;this.insertPathNumbers();$("g.group",a.svg.root()).bind("click.dizzy.editor.path",function(a){c.addPath($(a.currentTarget),parseInt(c.maxPathNumber,10)+1)});$(a.svg.root()).addClass("path")},insertPathNumbers:function(){var a=this,c=/group_(\d+)/;$("g.group",a.dizzy.svg.root()).each(function(){var b=$(this);b.data("pathCount","0");$(this.getAttribute("class").split(" ")).each(function(){var d=
c.exec(this);if(d!==null)for(var e=1;e<d.length;++e)a.addPath(b,d[e])})})},addPath:function(a,c){var b=this,d=a;d.is("g.group")||(d=$(a).parent("g.group").first());var f=d.data("pathCount");typeof f==="undefined"&&(f=0);var g=$(e).width()/2+31*(f%5),j=$(e).height()/2+31*Math.floor(f/5);d.addClass("group_"+c);var h=$(b.dizzy.svg.other(d,"g"));h.attr("class","pathNumberIndicator");var m=$(b.dizzy.svg.circle(d,0,0,15));m.attr("fill","#006000");var l=$(b.dizzy.svg.other(d,"text"));l.attr("text-anchor",
"middle").attr("font-size","20").attr("font-weight","bold").attr("y","5").attr("x","0").attr("fill","#FFFFFF");l.text(c);h.append(m);h.append(l);h.attr("transform","translate("+g+" "+j+")");h.data("number",c);d.append(h);d.data("pathCount",parseInt(f,10)+1);$("g.pathNumberIndicator",b.dizzy.svg.root()).bind("mousedown.dizzy.editor.path.move",function(a){return b.pathNumberDragStart(a)});if(c>this.maxPathNumber)this.maxPathNumber=c},pathNumberDragStart:function(a){var c=this;a.stopImmediatePropagation();
a=$(a.currentTarget);a.css("opacity","0.8");this.pathNumberDragOptions={};this.pathNumberDragOptions.group=a;this.pathNumberDragOptions.from=a.parent();this.pathNumberDragOptions.to=a.parent();a.detach();$(c.dizzy.svg.root()).append(a);$(e).bind("mousemove.dizzy.editor.path.move",function(a){return c.pathNumberDrag(a)});$("g.group",c.dizzy.svg.root()).bind("mouseenter.dizzy.editor.path.move.group",function(a){return c.pathNumberDrop(a)});$(e).bind("mouseup.dizzy.editor.path.move",function(a){return c.pathNumberDragEnd(a)});
return!1},pathNumberDrag:function(a){this.pathNumberDragOptions.group.attr("transform","translate("+(a.pageX+20)+" "+(a.pageY+20)+")");return!0},pathNumberDragEnd:function(a){a.stopImmediatePropagation();a=this.pathNumberDragOptions.group;a.detach();$(e).unbind("mousemove.dizzy.editor.path.move");$("g.group",this.dizzy.svg.root()).unbind("mouseenter.dizzy.editor.path.move.group");$(e).unbind("mouseup.dizzy.editor.path.move");var c=a.data("number"),b=this.pathNumberDragOptions.to;this.removePath(this.pathNumberDragOptions.from,
c);this.addPath(b,c);a.remove();return!1},pathNumberDrop:function(a){var c=$(a.currentTarget);this.pathNumberDragOptions.to=c;c.bind("mouseleave.dizzy.editor.path.move.group",function(){pathNumberDragOptions.to=this.pathNumberDragOptions.from;c.unbind("mouseleave.dizzy.editor.path.move.group")});return!0},removePath:function(a,c){var b=a;b.is("g.group")||(b=$(a).parent("g.group").first());var d=b.data("pathCount");b.data("pathCount",d-1);b.removeClass("group_"+c);var f=$(e).width()/2,g=$(e).height()/
2;b.children("g.pathNumberIndicator").each(function(){$(this).attr("transform","translate("+f+" "+g+")");f+=31})},finalize:function(a){$("g.group",a.svg.root()).unbind("click.dizzy.editor.path");$("g.pathNumberIndicator",a.svg.root()).remove();$(a.svg.root()).removeClass("path")}})})(window,document,Dizzy);
(function(f,e,g){g.registerPlugin({name:"editor",depends:["zoom","pan","editor.text","editor.images","editor.zebra"],options:{zoom:{duration:50}},initialize:function(a){$(a.svg.root()).addClass("editor")},finalize:function(a){$(a.svg.root()).removeClass("editor")}})})(window,document,Dizzy);
(function(f,e,g){g.registerPlugin({name:"editor.lines",depends:["zoom"],initialize:function(a){var c=this;this.dizzy=a;$(a.svg.root()).addClass("drawing");$(a.svg.root()).bind("mousedown.dizzy.editor.line",function(a){return c.editorLineStart(a)});$(a.svg.root()).bind("mouseup.dizzy.editor.line",function(a){return c.editorLineEnd(a)})},editorLineStart:function(a){var c=this;a.stopPropagation();a.preventDefault();$(this.dizzy.svg.root()).bind("mousemove.dizzy.editor.line",function(a){return c.editorLineDrag(a)});
var b=$(this.dizzy.svg.other($("#canvas"),"g"));b.attr("class","group");var d=this.dizzy.getTransformationMatrix(this.dizzy.canvas).inverse();b.attr("transform",this.dizzy.transformationMatrixToString(d));this.line=this.dizzy.svg.line(b,a.pageX,a.pageY,a.pageX,a.pageY,{stroke:this.dizzy.color.stroke,fill:this.dizzy.color.fill,strokeWidth:5});return!1},editorLineDrag:function(a){a.stopPropagation();a.preventDefault();this.line.setAttribute("y2",a.pageY);this.line.setAttribute("x2",a.pageX);return!1},
editorLineEnd:function(){$(this.dizzy.svg.root()).unbind("mousemove.dizzy.editor.line")},finalize:function(a){$(a.svg.root()).removeClass("drawing");$(a.svg.root()).unbind("mousedown.dizzy.editor.line");$(a.svg.root()).unbind("mouseup.dizzy.editor.line")}})})(window,document,Dizzy);
(function(f,e,g){g.registerPlugin({name:"editor.circles",depends:["zoom"],initialize:function(a){var c=this;this.dizzy=a;$(a.svg.root()).addClass("drawing");$(a.svg.root()).bind("mousedown.dizzy.editor.circle",function(a){return c.editorCircleStart(a)});$(a.svg.root()).bind("mouseup.dizzy.editor.circle",function(a){return c.editorCircleEnd(a)})},editorCircleStart:function(a){var c=this;a.stopPropagation();a.preventDefault();$(this.dizzy.svg.root()).bind("mousemove.dizzy.editor.circle",function(a){return c.editorCircleDrag(a)});
var b=$(this.dizzy.svg.other($("#canvas"),"g"));b.attr("class","group");var d=this.dizzy.getTransformationMatrix(this.dizzy.canvas).inverse(),d=d.translate(a.pageX-$(e).width()/2,a.pageY-$(e).height()/2);b.attr("transform",this.dizzy.transformationMatrixToString(d));this.circlePosition={x:a.pageX,y:a.pageY};this.line=this.dizzy.svg.ellipse(b,"50%","50%",1,1,{stroke:this.dizzy.color.stroke,fill:this.dizzy.color.fill,strokeWidth:5});return!1},editorCircleDrag:function(a){a.stopPropagation();a.preventDefault();
this.line.setAttribute("rx",Math.abs(this.circlePosition.x-a.pageX));this.line.setAttribute("ry",Math.abs(this.circlePosition.y-a.pageY));return!1},editorCircleEnd:function(){$(this.dizzy.svg.root()).unbind("mousemove.dizzy.editor.circle")},finalize:function(a){$(a.svg.root()).removeClass("drawing");$(a.svg.root()).unbind("mousedown.dizzy.editor.circle");$(a.svg.root()).unbind("mouseup.dizzy.editor.circle")}})})(window,document,Dizzy);
(function(f,e,g){g.registerPlugin({name:"editor.rect",depends:["zoom"],initialize:function(a){var c=this;this.dizzy=a;$(a.svg.root()).addClass("drawing");$(a.svg.root()).bind("mousedown.dizzy.editor.rect",function(a){return c.editorRectStart(a)});$(a.svg.root()).bind("mouseup.dizzy.editor.rect",function(a){return c.editorRectEnd(a)})},editorRectStart:function(a){var c=this;a.stopPropagation();a.preventDefault();$(this.dizzy.svg.root()).bind("mousemove.dizzy.editor.rect",function(a){return c.editorRectDrag(a)});
var b=$(this.dizzy.svg.other($("#canvas"),"g"));b.attr("class","group");var d=this.dizzy.getTransformationMatrix(this.dizzy.canvas).inverse(),d=d.translate(a.pageX-$(e).width()/2,a.pageY-$(e).height()/2);b.attr("transform",this.dizzy.transformationMatrixToString(d));this.circlePosition={x:a.pageX,y:a.pageY};this.line=this.dizzy.svg.rect(b,$(e).width()/2,$(e).height()/2,1,1,{stroke:this.dizzy.color.stroke,fill:this.dizzy.color.fill,strokeWidth:5});this.lineGroup=b;this.lineMatrixStart=d;this.lineStartPos=
{x:$(e).width()/2,y:$(e).height()/2};return!1},editorRectDrag:function(a){a.stopPropagation();a.preventDefault();var c=this.circlePosition.x-a.pageX,a=this.circlePosition.y-a.pageY;this.line.setAttribute("width",Math.abs(c));this.line.setAttribute("height",Math.abs(a));var b=-c/2,d=-a/2,e=this.lineMatrixStart,f=0,g=0;c>0&&(f+=c);a>0&&(g+=a);e=e.translate(b,d);this.lineGroup.attr("transform",this.dizzy.transformationMatrixToString(e));this.line.setAttribute("x",this.lineStartPos.x-(b+f));this.line.setAttribute("y",
this.lineStartPos.y-(d+g));return!1},editorRectEnd:function(){$(this.dizzy.svg.root()).unbind("mousemove.dizzy.editor.rect")},finalize:function(a){$(a.svg.root()).removeClass("drawing");$(a.svg.root()).unbind("mousedown.dizzy.editor.rect");$(a.svg.root()).unbind("mouseup.dizzy.editor.rect")}})})(window,document,Dizzy);
(function(f,e,g,a){g.registerPlugin({name:"editor.zebra",depends:["editor.tools"],options:{zoom:{duration:50}},initialize:function(a){var b=this;b.dizzy=a;var d=$(e);b.dizzy.svg.configure({viewBox:"0 0 "+d.width()+" "+d.height()},!0);$("g.group > *",a.svg.root()).live("click.dizzy.editor.default",function(a){return b.showZebra(a)});a=function(a){b.hideZebra(a)};$(e).bind("transformed",a);$(e).bind("hideZebra",a)},showZebra:function(a){var b=this,d=b.dizzy.svg.root(),f=$("#zebra");f.css("opacity",
"0.9");$("#zebra  #zebra-rotate").mousedown(function(a){return b.zebraRotateStart(a)});$("#zebra #zebra-scale").mousedown(function(a){return b.zebraScaleStart(a)});$("#zebra #zebra-translate").mousedown(function(a){return b.zebraTranslateStart(a)});var g=$(a.currentTarget.parentNode,d);this.selectedGroup=g;this.selectedTarget=$(a.currentTarget,d);this.selectedTarget.addClass("zebraSelected");g.css("opacity","0.6");f.css("left",a.pageX-75);f.css("top",a.pageY-75);f.show();$(e).bind("transformed",function(a){b.hideZebra(a)});
return!1},hideZebra:function(){$("#zebra").css("opacity","");$("#zebra").hide();isUndefined(this.selectedGroup)||this.selectedGroup.css("opacity","1");$(".zebraSelected").removeClass("zebraSelected");this.selectedTarget=this.selectedGroup=a;$("svg, #canvas",this.dizzy.svg.root()).unbind("mousedown.dizzy.editor.hidezebra");return!0},zebraScaleStart:function(){var a=this,b=$("#zebra");this.zebraScaleInfo={matrix:a.dizzy.getTransformationMatrix(this.selectedGroup),xa:parseFloat(b.css("left"))+75,ya:parseFloat(b.css("top"))+
75};$(e).bind("mousemove.dizzy.editor.scale",function(b){return a.zebraScale(b)});$(e).bind("mouseup.dizzy.editor",function(b){return a.zebraScaleEnd(b)});return!1},zebraScale:function(a){a={x:a.pageX,y:a.pageY};a={x:this.zebraScaleInfo.xa-a.x,y:this.zebraScaleInfo.ya-a.y};a=Math.sqrt(a.x*a.x+a.y*a.y)/40;this.dizzy.getTransformationMatrix(this.selectedGroup);this.selectedGroup.attr("transform",this.dizzy.transformationMatrixToString(this.zebraScaleInfo.matrix.translate(-$(e).width()/2*(a-1),-$(e).height()/
2*(a-1)).scale(a)));return!1},zebraScaleEnd:function(){$(e).unbind("mousemove.dizzy.editor.scale");$(e).unbind("mouseup.dizzy.editor");return!1},zebraTranslateStart:function(a){var b=this,d=b.dizzy.getTransformationMatrix(this.selectedGroup),a=b.dizzy.transformAbsoluteCoordinates(a.pageX,a.pageY,this.selectedGroup,!0,!0);this.zebraTranslateInfo={x:a.x,y:a.y,matrix:d};$(e).bind("mousemove.dizzy.editor.zebra.translate",function(a){return b.zebraTranslate(a)});$(e).bind("mouseup.dizzy.editor.zebra.translate",
function(a){return b.zebraTranslateEnd(a)});return!1},zebraTranslate:function(a){var b=this.dizzy.transformAbsoluteCoordinates(a.pageX,a.pageY,this.selectedGroup,!0,!0),d={};d.x=b.x-this.zebraTranslateInfo.x;d.y=b.y-this.zebraTranslateInfo.y;b=this.zebraTranslateInfo.matrix.translate(d.x,d.y);this.selectedGroup.attr("transform",this.dizzy.transformationMatrixToString(b));this.zebraTranslateInfo.matrix=b;b=$("#zebra");a=this.dizzy.transformAbsoluteCoordinates(a.pageX,a.pageY,$(this.dizzy.svg.root()),
!0);b.css("left",a.x-75);b.css("top",a.y-75);return!1},zebraTranslateEnd:function(){$(e).unbind("mousemove.dizzy.editor.zebra.translate");$(e).unbind("mouseup.dizzy.editor.zebra.translate");return!1},zebraRotateStart:function(a){var b=this,d=$("#zebra"),f=b.dizzy.getTransformationMatrix(this.selectedGroup),g=parseFloat(d.css("left"))+75,d=parseFloat(d.css("top"))+75;this.zebraRotateInfo={xa:g,ya:d,lastVector:{x:a.pageX-g,y:a.pageY-d},matrix:f};$(e).bind("mousemove.dizzy.editor.rotate",function(a){return b.zebraRotate(a)});
$(e).bind("mouseup.dizzy.editor.rotate",function(a){return b.zebraRotateEnd(a)});return!1},zebraRotate:function(a){$("#zebra");for(var a={x:a.pageX-this.zebraRotateInfo.xa,y:a.pageY-this.zebraRotateInfo.ya},b=this.zebraRotateInfo.lastVector,a=180/Math.PI*(Math.atan2(a.y,a.x)-Math.atan2(b.y,b.x)),b=$(e).width()/2,d=$(e).height()/2,b=this.zebraRotateInfo.matrix.translate(b,d).rotate(a).translate(-b,-d),d=["","-o-","-webkit-","-moz-","-ms-"],f=0;f<d.length;++f)$("#zebra-rotate").css(d[f]+"transform",
"rotate("+a+"deg)");this.selectedGroup.attr("transform",this.dizzy.transformationMatrixToString(b));return!1},zebraRotateEnd:function(){$(e).unbind("mousemove.dizzy.editor.rotate");$(e).unbind("mouseup.dizzy.editor.rotate");return!1},finalize:function(a){this.dizzy=a;this.hideZebra();$("g.group > *",a.svg.root()).die("click.dizzy.editor.default")}})})(window,document,Dizzy);
(function(f,e,g){g.registerPlugin({name:"nop",depends:[],options:{},initialize:function(){},finalize:function(){}})})(window,document,Dizzy);
$(function(){function f(a){$(a).siblings().removeClass("pressed");$(a).addClass("pressed")}function e(){c===!0?(c=!1,$("#toolbar").removeClass("invisible")):$("#toolbar").addClass("invisible");b=setTimeout(e,d)}function g(){$("#menu").toggleClass("hidden");$("#tools-main").toggleClass("expanded");isUndefined(i)?(i=a.activePlugin,a.switchPlugin("presentation")):(a.switchPlugin(i),i=void 0);k=k||$("#menu-right").text();$("#menu-right").html(k)}$("#dizzy").height($(document).height()).width($(document).width()).focus();
var a=new Dizzy("#dizzy",{zoomable:!0,pannable:!0,transformTime:1E3,zoomFactor:2});(function(b){a.load(b,function(){this.switchPlugin("editor");a.show(0);$("#menu-style-css-input").val($("#dizzy-internal-style").text());$(this.container).removeClass("loading")})})("./svg/blank.svg");$("#toolbar");$("#tool-default").click(function(){a.switchPlugin("editor");f(this)});$("#tool-path").click(function(){a.switchPlugin("editor.path");f(this)});$("#tool-circle").click(function(){a.switchPlugin("editor.circles");
f(this)});$("#tool-rect").click(function(){a.switchPlugin("editor.rect");f(this)});$("#tool-line").click(function(){a.switchPlugin("editor.lines");f(this)});$("#tool-previous").click(function(){a.previous()});$("#tool-next").click(function(){a.next()});var c=!1,b=0,d=500;$("#present-toggle-button").toggle(function(){a.switchPlugin("presentation");b=setTimeout(e,d);$(document).bind("mousemove",function(){c=!0});$(document).bind("keydown.presentation.navigation",function(b){b.which===32||b.which===
39?a.next():b.which===37&&a.previous()});$(".toolbutton").not(":first-child, :last-child").toggleClass("hidden");$("#present-toggle-button").children("span").text("End")},function(){a.switchPlugin("editor");clearTimeout(b);f($("#tool-default"));$(document).unbind("keydown.presentation.navigation");$(".toolbutton").not(":first-child, :last-child").toggleClass("hidden");$("#present-toggle-button").children("span").text("Present");$("#toolbar").removeClass("invisible")});$("#tool-image").bind("click",
function(){a.savePluginState();a.switchPlugin("nop");var b=$("#overlay, #overlay-dialog-input");b.removeClass("hidden");b.find('input[type="button"]').bind("click",function(){console.trace();$(this).unbind("click");var c=$("#image-dialog-file-field"),d=c[0].files;console.trace();if(d.length>0&&d[0].type.indexOf("image/")>=0){var e=new FileReader,d=d[0];e.onload=function(b){a.savePluginState();a.switchPlugin("editor");$(document).trigger("addImage",[b.target.result]);a.restorePluginState()};e.readAsDataURL(d);
c.parents("form")[0].reset()}else c=b.find("#overlay-dialog-input-field").val(),c!==void 0&&(a.savePluginState(),a.switchPlugin("editor"),$(document).trigger("addImage",[c]),a.restorePluginState());b.addClass("hidden")})});$("#tool-input-color-fill, #tool-input-color-stroke").bind("keydown keypress",function(a){a.preventDefault();return!0}).bind("input",function(){var a=$("#tool-input-color-fill").val(),b=$("#tool-input-color-stroke").val();$(document).trigger({type:"dizzy.color.changed",stroke:b,
fill:a});$(".zebraSelected").attr({stroke:b,fill:a})}).bind("click",function(){$(this).blur()});var i,k;$("#menu-button").bind("click",g);$("#menu-left li li").bind("mouseover",function(){var a=$(this),a=a.attr("data-description")||a.attr("title");$("#menu-right").text(a)});$("#menu-left li li:not(.inactive)").bind("click",function(){var a=$(this).children("div");a.toggleClass("hidden");a.bind("click",function(a){a.stopPropagation()})});$("#menu-open-input").bind("change",function(b){var c=b.target.files;
if(c.length>=1&&c[0].type==="image/svg+xml")b=new FileReader,c=c[0],b.onload=function(b){a.load(b.target.result,function(){g();a.switchPlugin("editor")})},b.readAsText(c)});$("#menu-save").bind("click",function(){a.switchPlugin("presentation");var b=a.serialize(),b="data:image/svg+xml;charset=utf-8;base64,"+$.base64Encode(b);window.open(b)});var j=$("#menu-style-css-input");j.bind("input blur",function(){$("#dizzy-internal-style").empty();$("#dizzy-internal-style").append(j.val())});$("#zebra-expand-button").bind("click",
function(){$("#zebra-toolbar").toggleClass("hidden");$(this).toggleClass("mirrored")});$(".overlay-close, .overlay-cancel").bind("click",function(){$("#overlay").addClass("hidden");a.restorePluginState()})});
